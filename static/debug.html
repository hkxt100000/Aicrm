<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è°ƒè¯• - æ™ºèƒ½è¡¨æ ¼åŠŸèƒ½</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            line-height: 1.6;
        }
        .debug-section {
            background: #f5f5f5;
            padding: 15px;
            margin: 15px 0;
            border-left: 4px solid #667eea;
        }
        .success { color: #28a745; }
        .error { color: #dc3545; }
        .warning { color: #ffc107; }
        button {
            padding: 10px 20px;
            margin: 5px;
            cursor: pointer;
        }
        #console-output {
            background: #000;
            color: #0f0;
            padding: 15px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            max-height: 400px;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <h1>ğŸ” æ™ºèƒ½è¡¨æ ¼åŠŸèƒ½è°ƒè¯•å·¥å…·</h1>
    
    <div class="debug-section">
        <h2>æµ‹è¯•æ­¥éª¤</h2>
        <button onclick="runTests()">â–¶ï¸ è¿è¡Œæ‰€æœ‰æµ‹è¯•</button>
        <button onclick="clearConsole()">ğŸ—‘ï¸ æ¸…ç©ºæ§åˆ¶å°</button>
        <button onclick="testDirectCall()">ğŸ¯ ç›´æ¥è°ƒç”¨å‡½æ•°</button>
    </div>
    
    <div class="debug-section">
        <h2>æ§åˆ¶å°è¾“å‡º</h2>
        <div id="console-output"></div>
    </div>
    
    <script>
        let consoleOutput = document.getElementById('console-output');
        
        function log(message, type = 'info') {
            const colors = {
                info: '#0f0',
                success: '#0f0',
                error: '#f00',
                warning: '#ff0'
            };
            const time = new Date().toLocaleTimeString();
            consoleOutput.innerHTML += `<div style="color: ${colors[type]}">[${time}] ${message}</div>`;
            consoleOutput.scrollTop = consoleOutput.scrollHeight;
            console.log(message);
        }
        
        function clearConsole() {
            consoleOutput.innerHTML = '';
        }
        
        async function runTests() {
            clearConsole();
            log('=== å¼€å§‹æµ‹è¯•æ™ºèƒ½è¡¨æ ¼åŠŸèƒ½ ===', 'info');
            log('');
            
            // æµ‹è¯• 1: æ£€æŸ¥ä¸»é¡µé¢æ˜¯å¦åŠ è½½
            log('[æµ‹è¯• 1] æ£€æŸ¥ä¸»é¡µé¢è®¿é—®...', 'info');
            try {
                const response = await fetch('/');
                if (response.ok) {
                    log('âœ… ä¸»é¡µé¢å¯ä»¥è®¿é—®', 'success');
                } else {
                    log(`âŒ ä¸»é¡µé¢è¿”å›é”™è¯¯: ${response.status}`, 'error');
                }
            } catch (e) {
                log(`âŒ ä¸»é¡µé¢è¯·æ±‚å¤±è´¥: ${e.message}`, 'error');
            }
            log('');
            
            // æµ‹è¯• 2: æ£€æŸ¥ script.js æ˜¯å¦åŠ è½½
            log('[æµ‹è¯• 2] æ£€æŸ¥ script.js æ–‡ä»¶...', 'info');
            try {
                const response = await fetch('/script.js');
                if (response.ok) {
                    const content = await response.text();
                    log(`âœ… script.js æ–‡ä»¶å¯ä»¥è®¿é—® (${(content.length / 1024).toFixed(2)} KB)`, 'success');
                    
                    if (content.includes('function showUploadExcelDialog')) {
                        log('âœ… æ‰¾åˆ° showUploadExcelDialog å‡½æ•°å®šä¹‰', 'success');
                    } else {
                        log('âŒ æœªæ‰¾åˆ° showUploadExcelDialog å‡½æ•°å®šä¹‰', 'error');
                    }
                } else {
                    log(`âŒ script.js è¿”å›é”™è¯¯: ${response.status}`, 'error');
                }
            } catch (e) {
                log(`âŒ script.js è¯·æ±‚å¤±è´¥: ${e.message}`, 'error');
            }
            log('');
            
            // æµ‹è¯• 3: åœ¨ä¸»é¡µé¢çš„ä¸Šä¸‹æ–‡ä¸­æµ‹è¯•
            log('[æµ‹è¯• 3] åœ¨ä¸»é¡µé¢ä¸Šä¸‹æ–‡ä¸­æµ‹è¯•...', 'info');
            log('âš ï¸  è¯·æ‰“å¼€ä¸»é¡µé¢ (http://127.0.0.1:9999)ï¼ŒæŒ‰ F12ï¼Œç„¶ååœ¨ Console ä¸­è¾“å…¥:', 'warning');
            log('   typeof showUploadExcelDialog', 'warning');
            log('   typeof closeUploadExcelDialog', 'warning');
            log('');
            
            // æµ‹è¯• 4: æ£€æŸ¥æ¨¡æ€æ¡†å…ƒç´ 
            log('[æµ‹è¯• 4] æµ‹è¯•è¯´æ˜...', 'info');
            log('åœ¨ä¸»é¡µé¢çš„ Console ä¸­è¾“å…¥ä»¥ä¸‹ä»£ç :', 'info');
            log('   document.getElementById("upload-excel-modal")', 'info');
            log('å¦‚æœè¿”å› nullï¼Œè¯´æ˜å…ƒç´ ä¸å­˜åœ¨', 'warning');
            log('');
            
            log('=== æµ‹è¯•å®Œæˆ ===', 'success');
            log('');
            log('ğŸ’¡ ä¿®å¤å»ºè®®:', 'info');
            log('1. å¦‚æœ showUploadExcelDialog æ˜¯ undefined:', 'info');
            log('   - æ£€æŸ¥ script.js æ˜¯å¦æœ‰è¯­æ³•é”™è¯¯', 'info');
            log('   - æŸ¥çœ‹æµè§ˆå™¨ Console æ˜¯å¦æœ‰ JavaScript é”™è¯¯', 'info');
            log('2. å¦‚æœå…ƒç´ ä¸å­˜åœ¨:', 'info');
            log('   - æ£€æŸ¥ HTML ä¸­æ˜¯å¦æœ‰ id="upload-excel-modal" çš„å…ƒç´ ', 'info');
            log('3. å¼ºåˆ¶åˆ·æ–°æµè§ˆå™¨ç¼“å­˜: Ctrl + Shift + R', 'info');
        }
        
        function testDirectCall() {
            log('');
            log('=== å°è¯•ç›´æ¥è°ƒç”¨å‡½æ•° ===', 'info');
            log('âš ï¸  è¿™ä¸ªé¡µé¢æ— æ³•ç›´æ¥è°ƒç”¨ä¸»é¡µé¢çš„å‡½æ•°', 'warning');
            log('è¯·åœ¨ä¸»é¡µé¢ (http://127.0.0.1:9999) çš„ Console ä¸­è¾“å…¥:', 'info');
            log('   showUploadExcelDialog()', 'info');
            log('');
        }
        
        // é¡µé¢åŠ è½½åè‡ªåŠ¨è¿è¡Œæµ‹è¯•
        window.addEventListener('DOMContentLoaded', () => {
            log('è°ƒè¯•å·¥å…·å·²åŠ è½½ï¼Œç‚¹å‡»"è¿è¡Œæ‰€æœ‰æµ‹è¯•"å¼€å§‹æµ‹è¯•', 'info');
        });
    </script>
</body>
</html>
