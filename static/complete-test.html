<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å®Œæ•´æµ‹è¯• - ä¸Šä¼  Excel åŠŸèƒ½</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            line-height: 1.6;
        }
        .test-section {
            background: #f5f5f5;
            padding: 15px;
            margin: 15px 0;
            border-left: 4px solid #667eea;
        }
        .success { color: #28a745; font-weight: bold; }
        .error { color: #dc3545; font-weight: bold; }
        .warning { color: #ffc107; font-weight: bold; }
        button {
            padding: 10px 20px;
            margin: 5px;
            cursor: pointer;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 4px;
        }
        button:hover {
            background: #5568d3;
        }
        .modal {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 30px;
            border: 2px solid #333;
            border-radius: 8px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
            z-index: 9999;
            min-width: 400px;
        }
        .modal.active {
            display: block;
        }
        .overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 9998;
        }
        .overlay.active {
            display: block;
        }
        #test-results {
            background: #000;
            color: #0f0;
            padding: 15px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            max-height: 400px;
            overflow-y: auto;
            margin-top: 15px;
        }
    </style>
</head>
<body>
    <h1>ğŸ” å®Œæ•´æµ‹è¯• - ä¸Šä¼  Excel åŠŸèƒ½</h1>
    
    <div class="test-section">
        <h2>æ–¹æ³• 1: onclick å±æ€§</h2>
        <button onclick="testMethod1()">
            ğŸ¯ æµ‹è¯• onclick="testMethod1()"
        </button>
        <p id="result1"></p>
    </div>
    
    <div class="test-section">
        <h2>æ–¹æ³• 2: addEventListener</h2>
        <button id="test-btn-2">
            ğŸ¯ æµ‹è¯• addEventListener
        </button>
        <p id="result2"></p>
    </div>
    
    <div class="test-section">
        <h2>æ–¹æ³• 3: æ¨¡æ‹ŸçœŸå®æŒ‰é’®</h2>
        <button class="btn-primary" id="btn-upload-excel">
            ğŸ“¤ ä¸Šä¼  Excelï¼ˆæ¨¡æ‹ŸçœŸå®æŒ‰é’®ï¼‰
        </button>
        <p id="result3"></p>
    </div>
    
    <div class="test-section">
        <h2>æµ‹è¯•ç»“æœ</h2>
        <div id="test-results"></div>
    </div>
    
    <!-- æ¨¡æ€æ¡† -->
    <div class="overlay" id="test-overlay" onclick="closeTestModal()"></div>
    <div class="modal" id="upload-excel-modal">
        <h3>âœ… ä¸Šä¼  Excel å¯¹è¯æ¡†</h3>
        <p>å¦‚æœæ‚¨çœ‹åˆ°è¿™ä¸ªå¯¹è¯æ¡†ï¼Œè¯´æ˜åŠŸèƒ½æ­£å¸¸å·¥ä½œï¼</p>
        <button onclick="closeTestModal()">å…³é—­å¯¹è¯æ¡†</button>
    </div>
    
    <script>
        let testResults = document.getElementById('test-results');
        
        function log(message, type = 'info') {
            const colors = {
                info: '#0f0',
                success: '#0f0',
                error: '#f00',
                warning: '#ff0'
            };
            const time = new Date().toLocaleTimeString();
            testResults.innerHTML += `<div style="color: ${colors[type]}">[${time}] ${message}</div>`;
            testResults.scrollTop = testResults.scrollHeight;
            console.log(message);
        }
        
        function showUploadExcelDialog() {
            log('[å‡½æ•°] showUploadExcelDialog è¢«è°ƒç”¨', 'success');
            const modal = document.getElementById('upload-excel-modal');
            const overlay = document.getElementById('test-overlay');
            if (modal) {
                modal.classList.add('active');
                overlay.classList.add('active');
                log('[å‡½æ•°] å¯¹è¯æ¡†å·²æ˜¾ç¤º', 'success');
            } else {
                log('[å‡½æ•°] æ‰¾ä¸åˆ°æ¨¡æ€æ¡†å…ƒç´ ', 'error');
            }
        }
        
        function closeTestModal() {
            log('[å‡½æ•°] å…³é—­å¯¹è¯æ¡†', 'info');
            document.getElementById('upload-excel-modal').classList.remove('active');
            document.getElementById('test-overlay').classList.remove('active');
        }
        
        // æ–¹æ³• 1: onclick å±æ€§
        function testMethod1() {
            log('', 'info');
            log('=== æµ‹è¯•æ–¹æ³• 1: onclick å±æ€§ ===', 'info');
            document.getElementById('result1').innerHTML = '<span class="success">âœ… onclick å¯ä»¥è°ƒç”¨å‡½æ•°</span>';
            showUploadExcelDialog();
        }
        
        // æ–¹æ³• 2: addEventListener
        document.addEventListener('DOMContentLoaded', () => {
            log('=== é¡µé¢åŠ è½½å®Œæˆ ===', 'info');
            log('', 'info');
            
            // ç»‘å®šæ–¹æ³• 2
            const btn2 = document.getElementById('test-btn-2');
            if (btn2) {
                log('[åˆå§‹åŒ–] æ‰¾åˆ°æµ‹è¯•æŒ‰é’® 2ï¼Œç»‘å®šäº‹ä»¶', 'success');
                btn2.addEventListener('click', () => {
                    log('', 'info');
                    log('=== æµ‹è¯•æ–¹æ³• 2: addEventListener ===', 'info');
                    document.getElementById('result2').innerHTML = '<span class="success">âœ… addEventListener å¯ä»¥è°ƒç”¨å‡½æ•°</span>';
                    showUploadExcelDialog();
                });
            } else {
                log('[åˆå§‹åŒ–] æœªæ‰¾åˆ°æµ‹è¯•æŒ‰é’® 2', 'error');
            }
            
            // ç»‘å®šæ–¹æ³• 3ï¼ˆæ¨¡æ‹ŸçœŸå®æŒ‰é’®ï¼‰
            const btnUploadExcel = document.getElementById('btn-upload-excel');
            if (btnUploadExcel) {
                log('[åˆå§‹åŒ–] æ‰¾åˆ°ä¸Šä¼ æŒ‰é’®ï¼Œç»‘å®šäº‹ä»¶', 'success');
                btnUploadExcel.addEventListener('click', () => {
                    log('', 'info');
                    log('=== æµ‹è¯•æ–¹æ³• 3: æ¨¡æ‹ŸçœŸå®æŒ‰é’® ===', 'info');
                    document.getElementById('result3').innerHTML = '<span class="success">âœ… æ¨¡æ‹ŸçœŸå®æŒ‰é’®å¯ä»¥å·¥ä½œ</span>';
                    showUploadExcelDialog();
                });
            } else {
                log('[åˆå§‹åŒ–] æœªæ‰¾åˆ°ä¸Šä¼ æŒ‰é’®', 'error');
            }
            
            // æ£€æŸ¥å‡½æ•°
            log('', 'info');
            log('=== æ£€æŸ¥å‡½æ•°å®šä¹‰ ===', 'info');
            log('typeof showUploadExcelDialog: ' + typeof showUploadExcelDialog, 'info');
            log('typeof closeTestModal: ' + typeof closeTestModal, 'info');
            
            // æ£€æŸ¥å…ƒç´ 
            log('', 'info');
            log('=== æ£€æŸ¥ DOM å…ƒç´  ===', 'info');
            log('upload-excel-modal: ' + (document.getElementById('upload-excel-modal') ? 'âœ… å­˜åœ¨' : 'âŒ ä¸å­˜åœ¨'), 'info');
            log('test-overlay: ' + (document.getElementById('test-overlay') ? 'âœ… å­˜åœ¨' : 'âŒ ä¸å­˜åœ¨'), 'info');
            log('', 'info');
            log('=== æµ‹è¯•å°±ç»ªï¼Œè¯·ç‚¹å‡»ä¸Šé¢çš„æŒ‰é’®æµ‹è¯• ===', 'success');
        });
    </script>
</body>
</html>
